{% extends "base.html" %}

{% block title %}Events - TechSphere{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 dark:bg-gray-900">
    <!-- Header Section -->
    <div class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex items-center justify-between">
                <div class="animate-on-scroll">
                    <h1 class="text-3xl font-bold text-gray-900 dark:text-white flex items-center">
                        <i data-lucide="calendar" class="w-8 h-8 mr-3 text-blue-600 dark:text-blue-400"></i>
                        Events & Competitions
                    </h1>
                    <p class="text-gray-600 dark:text-gray-300 mt-2">
                        Discover hackathons, workshops, seminars, and competitions in our tech community
                    </p>
                </div>
                {% if current_user.is_admin %}
                <div class="animate-on-scroll">
                    <a href="{{ url_for('admin_create_event') }}" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors duration-200 flex items-center">
                        <i data-lucide="plus" class="w-5 h-5 mr-2"></i>
                        Create Event
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Filter Section -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 animate-on-scroll">
            <div class="flex flex-wrap items-center gap-4">
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Filter by type:</span>
                <div class="flex flex-wrap gap-2">
                    <a href="{{ url_for('events', type='all') }}" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if current_type == 'all' %}bg-blue-600 text-white{% else %}bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600{% endif %}">
                        All Events
                    </a>
                    <a href="{{ url_for('events', type='hackathon') }}" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if current_type == 'hackathon' %}bg-blue-600 text-white{% else %}bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600{% endif %}">
                        <i data-lucide="code" class="w-4 h-4 inline mr-1"></i>
                        Hackathons
                    </a>
                    <a href="{{ url_for('events', type='workshop') }}" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if current_type == 'workshop' %}bg-blue-600 text-white{% else %}bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600{% endif %}">
                        <i data-lucide="wrench" class="w-4 h-4 inline mr-1"></i>
                        Workshops
                    </a>
                    <a href="{{ url_for('events', type='seminar') }}" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if current_type == 'seminar' %}bg-blue-600 text-white{% else %}bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600{% endif %}">
                        <i data-lucide="presentation" class="w-4 h-4 inline mr-1"></i>
                        Seminars
                    </a>
                    <a href="{{ url_for('events', type='competition') }}" class="filter-btn px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if current_type == 'competition' %}bg-blue-600 text-white{% else %}bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600{% endif %}">
                        <i data-lucide="trophy" class="w-4 h-4 inline mr-1"></i>
                        Competitions
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Events Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
        <!-- Upcoming Events -->
        {% if upcoming %}
        <div class="mb-12 animate-on-scroll">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center">
                <i data-lucide="clock" class="w-6 h-6 mr-2 text-green-600 dark:text-green-400"></i>
                Upcoming Events
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for event in upcoming %}
                <div class="event-card bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
                    <div class="p-6">
                        <!-- Event Type Badge -->
                        <div class="flex items-center justify-between mb-4">
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium {% if event.event_type == 'hackathon' %}bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400{% elif event.event_type == 'workshop' %}bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400{% elif event.event_type == 'seminar' %}bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400{% else %}bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400{% endif %}">
                                <i data-lucide="{% if event.event_type == 'hackathon' %}code{% elif event.event_type == 'workshop' %}wrench{% elif event.event_type == 'seminar' %}presentation{% else %}trophy{% endif %}" class="w-3 h-3 mr-1"></i>
                                {{ event.event_type.title() }}
                            </span>
                            <div class="text-right">
                                <div class="text-xs text-gray-500 dark:text-gray-400">
                                    {{ event.start_date.strftime('%b %d') }}
                                </div>
                            </div>
                        </div>

                        <!-- Event Title -->
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-2">
                            {{ event.title }}
                        </h3>

                        <!-- Event Description -->
                        <p class="text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-3">
                            {{ event.description }}
                        </p>

                        <!-- Event Details -->
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="calendar" class="w-4 h-4 mr-2"></i>
                                {{ event.start_date.strftime('%B %d, %Y at %I:%M %p') }}
                            </div>
                            {% if event.venue %}
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="map-pin" class="w-4 h-4 mr-2"></i>
                                {{ event.venue }}
                            </div>
                            {% endif %}
                            {% if event.virtual_link %}
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="video" class="w-4 h-4 mr-2"></i>
                                Virtual Event
                            </div>
                            {% endif %}
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="users" class="w-4 h-4 mr-2"></i>
                                {% if event.min_team_size > 1 %}
                                    {{ event.team_registrations|length }} teams registered
                                {% else %}
                                    {{ event.registrations|length }} registered
                                {% endif %}
                                {% if event.max_participants %}
                                    / {{ event.max_participants }} max
                                {% endif %}
                            </div>
                        </div>

                        <!-- Registration Status -->
                        <div class="flex items-center justify-between">
                            {% if event.registration_deadline and event.registration_deadline < utcnow() %}
                                <span class="text-red-600 dark:text-red-400 text-sm font-medium">Registration Closed</span>
                            {% elif event.max_participants and event.registrations|length >= event.max_participants %}
                                <span class="text-orange-600 dark:text-orange-400 text-sm font-medium">Event Full</span>
                            {% else %}
                                <span class="text-green-600 dark:text-green-400 text-sm font-medium">Registration Open</span>
                            {% endif %}
                            
                            <a href="{{ url_for('event_detail', event_id=event.id) }}" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200">
                                View Details
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Ongoing Events -->
        {% if ongoing %}
        <div class="mb-12 animate-on-scroll">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center">
                <i data-lucide="play-circle" class="w-6 h-6 mr-2 text-blue-600 dark:text-blue-400"></i>
                Ongoing Events
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for event in ongoing %}
                <div class="event-card bg-white dark:bg-gray-800 rounded-xl shadow-sm border-2 border-blue-200 dark:border-blue-800 overflow-hidden relative">
                    <!-- Live Badge -->
                    <div class="absolute top-4 right-4 z-10">
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400">
                            <div class="w-2 h-2 bg-red-500 rounded-full mr-1 animate-pulse"></div>
                            LIVE
                        </span>
                    </div>

                    <div class="p-6">
                        <!-- Event Type Badge -->
                        <div class="mb-4">
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400">
                                <i data-lucide="{% if event.event_type == 'hackathon' %}code{% elif event.event_type == 'workshop' %}wrench{% elif event.event_type == 'seminar' %}presentation{% else %}trophy{% endif %}" class="w-3 h-3 mr-1"></i>
                                {{ event.event_type.title() }}
                            </span>
                        </div>

                        <!-- Event Title -->
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-2">
                            {{ event.title }}
                        </h3>

                        <!-- Event Details -->
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="clock" class="w-4 h-4 mr-2"></i>
                                Ends {{ event.end_date.strftime('%B %d at %I:%M %p') }}
                            </div>
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="users" class="w-4 h-4 mr-2"></i>
                                {{ event.registrations|length }} participants
                            </div>
                        </div>

                        <a href="{{ url_for('event_detail', event_id=event.id) }}" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 block text-center">
                            Join Now
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Past Events -->
        {% if past %}
        <div class="animate-on-scroll">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center">
                <i data-lucide="archive" class="w-6 h-6 mr-2 text-gray-600 dark:text-gray-400"></i>
                Past Events
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for event in past %}
                <div class="event-card bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden opacity-75 hover:opacity-100 transition-opacity duration-300">
                    <div class="p-6">
                        <!-- Event Type Badge -->
                        <div class="flex items-center justify-between mb-4">
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400">
                                <i data-lucide="{% if event.event_type == 'hackathon' %}code{% elif event.event_type == 'workshop' %}wrench{% elif event.event_type == 'seminar' %}presentation{% else %}trophy{% endif %}" class="w-3 h-3 mr-1"></i>
                                {{ event.event_type.title() }}
                            </span>
                            <span class="text-xs text-gray-500 dark:text-gray-400">Completed</span>
                        </div>

                        <!-- Event Title -->
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-2">
                            {{ event.title }}
                        </h3>

                        <!-- Event Details -->
                        <div class="space-y-2 mb-4">
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="calendar" class="w-4 h-4 mr-2"></i>
                                {{ event.start_date.strftime('%B %d, %Y') }}
                            </div>
                            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
                                <i data-lucide="users" class="w-4 h-4 mr-2"></i>
                                {{ event.registrations|length }} participated
                            </div>
                        </div>

                        <a href="{{ url_for('event_detail', event_id=event.id) }}" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 inline-block">
                            View Results
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- No Events Message -->
        {% if not upcoming and not ongoing and not past %}
        <div class="text-center py-16 animate-on-scroll">
            <i data-lucide="calendar-x" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">No events found</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-6">
                {% if current_type != 'all' %}
                    No {{ current_type }}s are currently available. Try checking other event types.
                {% else %}
                    There are no events at the moment. Check back later for exciting opportunities!
                {% endif %}
            </p>
            {% if current_user.is_admin %}
            <a href="{{ url_for('admin_create_event') }}" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200">
                Create First Event
            </a>
            {% endif %}
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Event card hover animations
    document.querySelectorAll('.event-card').forEach(card => {
        card.addEventListener('mouseenter', () => {
            gsap.to(card, { scale: 1.02, duration: 0.3, ease: "power2.out" });
        });
        
        card.addEventListener('mouseleave', () => {
            gsap.to(card, { scale: 1, duration: 0.3, ease: "power2.out" });
        });
    });

    // Filter button animations
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('mouseenter', () => {
            if (!btn.classList.contains('bg-blue-600')) {
                gsap.to(btn, { scale: 1.05, duration: 0.2, ease: "power2.out" });
            }
        });
        
        btn.addEventListener('mouseleave', () => {
            gsap.to(btn, { scale: 1, duration: 0.2, ease: "power2.out" });
        });
    });

    // Staggered animations for event cards
    gsap.from('.event-card', {
        opacity: 0,
        y: 30,
        duration: 0.6,
        stagger: 0.1,
        ease: "power2.out",
        delay: 0.2
    });
</script>
{% endblock %}
